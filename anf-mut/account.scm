;; Expected result: 30
(let ((message-withdraw 0)) (let ((message-deposit 1)) (letrec ((make-account (lambda (balance) (letrec ((withdraw (lambda (amount) (let ((_16 (>= balance amount))) (if _16 (let ((_19 (- balance amount))) (let ((_18 _19)) (let ((_17 (set! balance _18))) balance))) -1))))) (letrec ((deposit (lambda (amount) (let ((_22 (+ balance amount))) (let ((_21 _22)) (let ((_20 (set! balance _21))) balance)))))) (letrec ((dispatch (lambda (m) (let ((_23 (= m message-withdraw))) (if _23 withdraw (let ((_24 (= m message-deposit))) (if _24 deposit -2))))))) dispatch)))))) (let ((_25 (make-account 100))) (let ((account _25)) (let ((_38 (account message-withdraw))) (let ((_27 _38)) (let ((_39 (_27 50))) (let ((_28 _39)) (let ((_26 _28)) (let ((_40 (account message-withdraw))) (let ((_30 _40)) (let ((_41 (_30 60))) (let ((_31 _41)) (let ((_29 _31)) (let ((_42 (account message-deposit))) (let ((_33 _42)) (let ((_43 (_33 40))) (let ((_34 _43)) (let ((_32 _34)) (let ((_44 (account message-withdraw))) (let ((_36 _44)) (let ((_45 (_36 60))) (let ((_37 _45)) (let ((_35 _37)) 30)))))))))))))))))))))))))
