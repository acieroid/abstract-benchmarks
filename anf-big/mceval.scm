(let ((_self-evaluating?0 (lambda (_exp1) (let ((_p186 (number? _exp1))) (if _p186 #t (let ((_p187 (string? _exp1))) (if _p187 #t #f))))))) (let ((_variable?2 (lambda (_exp3) (symbol? _exp3)))) (let ((_tagged-list?4 (lambda (_exp5 _tag6) (let ((_p188 (pair? _exp5))) (if _p188 (let ((_p189 (car _exp5))) (eq? _p189 _tag6)) #f))))) (let ((_quoted?7 (lambda (_exp8) (_tagged-list?4 _exp8 'quote)))) (let ((_text-of-quotation9 (lambda (_exp10) (cadr _exp10)))) (let ((_assignment?11 (lambda (_exp12) (_tagged-list?4 _exp12 'set!)))) (let ((_assignment-variable13 (lambda (_exp14) (cadr _exp14)))) (let ((_assignment-value15 (lambda (_exp16) (caddr _exp16)))) (let ((_definition?17 (lambda (_exp18) (_tagged-list?4 _exp18 'define)))) (let ((_definition-variable19 (lambda (_exp20) (let ((_p190 (cadr _exp20))) (let ((_p191 (symbol? _p190))) (if _p191 (cadr _exp20) (caadr _exp20))))))) (let ((_make-lambda21 (lambda (_parameters22 _body23) (let ((_p192 (cons _parameters22 _body23))) (cons 'lambda _p192))))) (let ((_definition-value24 (lambda (_exp25) (let ((_p193 (cadr _exp25))) (let ((_p194 (symbol? _p193))) (if _p194 (caddr _exp25) (let ((_p195 (cdadr _exp25))) (let ((_p196 (cddr _exp25))) (_make-lambda21 _p195 _p196))))))))) (let ((_lambda?26 (lambda (_exp27) (_tagged-list?4 _exp27 'lambda)))) (let ((_lambda-parameters28 (lambda (_exp29) (cadr _exp29)))) (let ((_lambda-body30 (lambda (_exp31) (cddr _exp31)))) (let ((_if?32 (lambda (_exp33) (_tagged-list?4 _exp33 'if)))) (let ((_if-predicate34 (lambda (_exp35) (cadr _exp35)))) (let ((_if-consequent36 (lambda (_exp37) (caddr _exp37)))) (let ((_if-alternative38 (lambda (_exp39) (let ((_p197 (cdddr _exp39))) (let ((_p198 (null? _p197))) (let ((_p199 (not _p198))) (if _p199 (cadddr _exp39) 'false))))))) (let ((_make-if40 (lambda (_predicate41 _consequent42 _alternative43) (list 'if _predicate41 _consequent42 _alternative43)))) (let ((_begin?44 (lambda (_exp45) (_tagged-list?4 _exp45 'begin)))) (let ((_begin-actions46 (lambda (_exp47) (cdr _exp47)))) (let ((_last-exp?48 (lambda (_seq49) (let ((_p200 (cdr _seq49))) (null? _p200))))) (let ((_first-exp50 (lambda (_seq51) (car _seq51)))) (let ((_rest-exps52 (lambda (_seq53) (cdr _seq53)))) (let ((_mk-begin54 (lambda (_seq55) (cons 'begin _seq55)))) (let ((_sequence->exp56 (lambda (_seq57) (let ((_p201 (null? _seq57))) (if _p201 _seq57 (let ((_p202 (_last-exp?48 _seq57))) (if _p202 (_first-exp50 _seq57) (_mk-begin54 _seq57)))))))) (let ((_application?58 (lambda (_exp59) (pair? _exp59)))) (let ((_operator60 (lambda (_exp61) (car _exp61)))) (let ((_operands62 (lambda (_exp63) (cdr _exp63)))) (let ((_no-operands?64 (lambda (_ops65) (null? _ops65)))) (let ((_first-operand66 (lambda (_ops67) (car _ops67)))) (let ((_rest-operands68 (lambda (_ops69) (cdr _ops69)))) (let ((_cond?70 (lambda (_exp71) (_tagged-list?4 _exp71 'cond)))) (let ((_cond-clauses72 (lambda (_exp73) (cdr _exp73)))) (let ((_cond-predicate74 (lambda (_clause75) (car _clause75)))) (let ((_cond-else-clause?76 (lambda (_clause77) (let ((_p203 (_cond-predicate74 _clause77))) (eq? _p203 'else))))) (let ((_cond-actions78 (lambda (_clause79) (cdr _clause79)))) (letrec ((_expand-clauses80 (lambda (_clauses81) (let ((_p204 (null? _clauses81))) (if _p204 'false (let ((_first82 (car _clauses81))) (let ((_rest83 (cdr _clauses81))) (let ((_p205 (_cond-else-clause?76 _first82))) (if _p205 (let ((_p206 (null? _rest83))) (if _p206 (let ((_p207 (_cond-actions78 _first82))) (_sequence->exp56 _p207)) (error "ELSE clause isn't last -- COND->IF" _clauses81))) (let ((_p208 (_cond-predicate74 _first82))) (let ((_p209 (_cond-actions78 _first82))) (let ((_p210 (_sequence->exp56 _p209))) (let ((_p211 (_expand-clauses80 _rest83))) (_make-if40 _p208 _p210 _p211)))))))))))))) (let ((_cond->if84 (lambda (_exp85) (let ((_p212 (_cond-clauses72 _exp85))) (_expand-clauses80 _p212))))) (let ((_true?86 (lambda (_x87) (let ((_p213 (eq? _x87 #f))) (not _p213))))) (let ((_false?88 (lambda (_x89) (eq? _x89 #f)))) (let ((_make-procedure90 (lambda (_parameters91 _body92 _env93) (list procedure _parameters91 _body92 _env93)))) (let ((_compound-procedure?94 (lambda (_p95) (_tagged-list?4 _p95 procedure)))) (let ((_procedure-parameters96 (lambda (_p97) (cadr _p97)))) (let ((_procedure-body98 (lambda (_p99) (caddr _p99)))) (let ((_procedure-environment100 (lambda (_p101) (cadddr _p101)))) (let ((_enclosing-environment102 (lambda (_env103) (cdr _env103)))) (let ((_first-frame104 (lambda (_env105) (car _env105)))) (let ((_the-empty-environment106 '())) (let ((_make-frame107 (lambda (_variables108 _values109) (cons _variables108 _values109)))) (let ((_frame-variables110 (lambda (_frame111) (car _frame111)))) (let ((_frame-values112 (lambda (_frame113) (cdr _frame113)))) (let ((_add-binding-to-frame!114 (lambda (_var115 _val116 _frame117) (let ((_p214 (car _frame117))) (let ((_p215 (cons _var115 _p214))) (let ((_$216 (set-car! _frame117 _p215))) (let ((_p217 (cdr _frame117))) (let ((_p218 (cons _val116 _p217))) (set-cdr! _frame117 _p218))))))))) (let ((_extend-environment118 (lambda (_vars119 _vals120 _base-env121) (let ((_p219 (length _vars119))) (let ((_p220 (length _vals120))) (let ((_p221 (= _p219 _p220))) (if _p221 (let ((_p222 (_make-frame107 _vars119 _vals120))) (cons _p222 _base-env121)) (let ((_p223 (length _vars119))) (let ((_p224 (length _vals120))) (let ((_p225 (< _p223 _p224))) (if _p225 (error "Too many arguments supplied" _vars119 _vals120) (error "Too few arguments supplied" _vars119 _vals120)))))))))))) (let ((_lookup-variable-value122 (lambda (_var123 _env124) (letrec ((_env-loop125 (lambda (_env126) (letrec ((_scan127 (lambda (_vars128 _vals129) (let ((_p226 (null? _vars128))) (if _p226 (let ((_p227 (_enclosing-environment102 _env126))) (_env-loop125 _p227)) (let ((_p228 (car _vars128))) (let ((_p229 (eq? _var123 _p228))) (if _p229 (car _vals129) (let ((_p230 (cdr _vars128))) (let ((_p231 (cdr _vals129))) (_scan127 _p230 _p231))))))))))) (let ((_p232 (eq? _env126 _the-empty-environment106))) (if _p232 (error "Unbound variable" _var123) (let ((_frame130 (_first-frame104 _env126))) (let ((_p233 (_frame-variables110 _frame130))) (let ((_p234 (_frame-values112 _frame130))) (_scan127 _p233 _p234)))))))))) (_env-loop125 _env124))))) (let ((_set-variable-value!131 (lambda (_var132 _val133 _env134) (letrec ((_env-loop135 (lambda (_env136) (letrec ((_scan137 (lambda (_vars138 _vals139) (let ((_p235 (null? _vars138))) (if _p235 (let ((_p236 (_enclosing-environment102 _env136))) (_env-loop135 _p236)) (let ((_p237 (car _vars138))) (let ((_p238 (eq? _var132 _p237))) (if _p238 (set-car! _vals139 _val133) (let ((_p239 (cdr _vars138))) (let ((_p240 (cdr _vals139))) (_scan137 _p239 _p240))))))))))) (let ((_p241 (eq? _env136 _the-empty-environment106))) (if _p241 (error "Unbound variable -- SET!" _var132) (let ((_frame140 (_first-frame104 _env136))) (let ((_p242 (_frame-variables110 _frame140))) (let ((_p243 (_frame-values112 _frame140))) (_scan137 _p242 _p243)))))))))) (_env-loop135 _env134))))) (let ((_define-variable!141 (lambda (_var142 _val143 _env144) (let ((_frame145 (_first-frame104 _env144))) (letrec ((_scan146 (lambda (_vars147 _vals148) (let ((_p244 (null? _vars147))) (if _p244 (_add-binding-to-frame!114 _var142 _val143 _frame145) (let ((_p245 (car _vars147))) (let ((_p246 (eq? _var142 _p245))) (if _p246 (set-car! _vals148 _val143) (let ((_p247 (cdr _vars147))) (let ((_p248 (cdr _vals148))) (_scan146 _p247 _p248))))))))))) (let ((_p249 (_frame-variables110 _frame145))) (let ((_p250 (_frame-values112 _frame145))) (_scan146 _p249 _p250)))))))) (let ((_primitive-procedure?149 (lambda (_proc150) (_tagged-list?4 _proc150 'primitive)))) (let ((_primitive-implementation151 (lambda (_proc152) (cadr _proc152)))) (let ((_p251 (list car car))) (let ((_p252 (list cdr cdr))) (let ((_p253 (list 'cons cons))) (let ((_p254 (list 'null? null?))) (let ((_p255 (list '= =))) (let ((_p256 (list '* *))) (let ((_p257 (list '- -))) (let ((_primitive-procedures153 (list _p251 _p252 _p253 _p254 _p255 _p256 _p257))) (let ((_primitive-procedure-names154 (lambda () (map car _primitive-procedures153)))) (let ((_primitive-procedure-objects155 (lambda () (map (lambda (_proc156) (let ((_p258 (cadr _proc156))) (list 'primitive _p258))) _primitive-procedures153)))) (let ((_setup-environment157 (lambda () (let ((_p259 (_primitive-procedure-names154))) (let ((_p260 (_primitive-procedure-objects155))) (let ((_initial-env158 (_extend-environment118 _p259 _p260 _the-empty-environment106))) (let ((_$261 (_define-variable!141 'true #t _initial-env158))) (let ((_$262 (_define-variable!141 'false #f _initial-env158))) _initial-env158)))))))) (let ((_the-global-environment159 (_setup-environment157))) (let ((_apply-primitive-procedure160 (lambda (_proc161 _args162) (let ((_f163 (_primitive-implementation151 _proc161))) (let ((_n164 (length _args162))) (let ((_p263 (= _n164 0))) (if _p263 (_f163) (let ((_p264 (= _n164 1))) (if _p264 (let ((_p265 (car _args162))) (_f163 _p265)) (let ((_p266 (= _n164 2))) (if _p266 (let ((_p267 (car _args162))) (let ((_p268 (cadr _args162))) (_f163 _p267 _p268))) (error "ERROR -- can't handle more than two arguments")))))))))))) (letrec ((_mceval165 (lambda (_exp166 _env167) (letrec ((_eval-sequence168 (lambda (_exps169 _env170) (let ((_p269 (_last-exp?48 _exps169))) (if _p269 (let ((_p270 (_first-exp50 _exps169))) (_mceval165 _p270 _env170)) (let ((_p271 (_first-exp50 _exps169))) (let ((_$272 (_mceval165 _p271 _env170))) (let ((_p273 (_rest-exps52 _exps169))) (_eval-sequence168 _p273 _env170))))))))) (let ((_mcapply171 (lambda (_procedure172 _arguments173) (let ((_p274 (_primitive-procedure?149 _procedure172))) (if _p274 (_apply-primitive-procedure160 _procedure172 _arguments173) (let ((_p275 (_compound-procedure?94 _procedure172))) (if _p275 (let ((_p276 (_procedure-body98 _procedure172))) (let ((_p277 (_procedure-parameters96 _procedure172))) (let ((_p278 (_procedure-environment100 _procedure172))) (let ((_p279 (_extend-environment118 _p277 _arguments173 _p278))) (_eval-sequence168 _p276 _p279))))) (error "Unknown procedure type -- APPLY" _procedure172)))))))) (let ((_eval-if174 (lambda (_exp175 _env176) (let ((_p280 (_if-predicate34 _exp175))) (let ((_p281 (_mceval165 _p280 _env176))) (let ((_p282 (_true?86 _p281))) (if _p282 (let ((_p283 (_if-consequent36 _exp175))) (_mceval165 _p283 _env176)) (let ((_p284 (_if-alternative38 _exp175))) (_mceval165 _p284 _env176))))))))) (let ((_eval-assignment177 (lambda (_exp178 _env179) (let ((_p285 (_assignment-variable13 _exp178))) (let ((_p286 (_assignment-value15 _exp178))) (let ((_p287 (_mceval165 _p286 _env179))) (let ((_$288 (_set-variable-value!131 _p285 _p287 _env179))) 'ok))))))) (let ((_eval-definition180 (lambda (_exp181 _env182) (let ((_p289 (_definition-variable19 _exp181))) (let ((_p290 (_definition-value24 _exp181))) (let ((_p291 (_mceval165 _p290 _env182))) (let ((_$292 (_define-variable!141 _p289 _p291 _env182))) 'ok))))))) (letrec ((_list-of-values183 (lambda (_exps184 _env185) (let ((_p293 (_no-operands?64 _exps184))) (if _p293 '() (let ((_p294 (_first-operand66 _exps184))) (let ((_p295 (_mceval165 _p294 _env185))) (let ((_p296 (_rest-operands68 _exps184))) (let ((_p297 (_list-of-values183 _p296 _env185))) (cons _p295 _p297)))))))))) (let ((_p298 (_self-evaluating?0 _exp166))) (if _p298 _exp166 (let ((_p299 (_variable?2 _exp166))) (if _p299 (_lookup-variable-value122 _exp166 _env167) (let ((_p300 (_quoted?7 _exp166))) (if _p300 (_text-of-quotation9 _exp166) (let ((_p301 (_assignment?11 _exp166))) (if _p301 (_eval-assignment177 _exp166 _env167) (let ((_p302 (_definition?17 _exp166))) (if _p302 (_eval-definition180 _exp166 _env167) (let ((_p303 (_if?32 _exp166))) (if _p303 (_eval-if174 _exp166 _env167) (let ((_p304 (_lambda?26 _exp166))) (if _p304 (let ((_p305 (_lambda-parameters28 _exp166))) (let ((_p306 (_lambda-body30 _exp166))) (_make-procedure90 _p305 _p306 _env167))) (let ((_p307 (_begin?44 _exp166))) (if _p307 (let ((_p308 (_begin-actions46 _exp166))) (_eval-sequence168 _p308 _env167)) (let ((_p309 (_cond?70 _exp166))) (if _p309 (let ((_p310 (_cond->if84 _exp166))) (_mceval165 _p310 _env167)) (let ((_p311 (_application?58 _exp166))) (if _p311 (let ((_p312 (_operator60 _exp166))) (let ((_p313 (_mceval165 _p312 _env167))) (let ((_p314 (_operands62 _exp166))) (let ((_p315 (_list-of-values183 _p314 _env167))) (_mcapply171 _p313 _p315))))) (error "Unknown expression type -- EVAL" _exp166)))))))))))))))))))))))))))))) (let ((_$316 (_mceval165 '(define (fac n) (if (= n 0) 1 (* n (fac (- n 1))))) _the-global-environment159))) (_mceval165 '(fac 8) _the-global-environment159))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))
