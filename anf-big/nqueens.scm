;; Expected result: 92
(letrec ((append (lambda (l x) (let ((_30 (null? l))) (if _30 x (let ((_33 (car l))) (let ((_34 (cdr l))) (let ((_31 _34)) (let ((_35 (append _31 x))) (let ((_32 _35)) (let ((_36 (cons _33 _32))) _36))))))))))) (letrec ((one-to (lambda (n) (letrec ((loop (lambda (i l) (let ((_37 (= i 0))) (if _37 l (let ((_38 (- i 1))) (let ((_39 (cons i l))) (let ((_40 (loop _38 _39))) _40)))))))) (let ((_41 (quote ()))) (let ((_42 (loop n _41))) _42)))))) (letrec ((ok? (lambda (row dist placed) (let ((_43 (null? placed))) (if _43 #t (let ((_61 (car placed))) (let ((_47 _61)) (let ((_44 _47)) (let ((_62 (+ row dist))) (let ((_48 _62)) (let ((_45 _48)) (let ((_63 (= _44 _45))) (let ((_49 _63)) (let ((_46 _49)) (let ((_64 (not _46))) (let ((_50 _64)) (let ((_65 (car placed))) (let ((_54 _65)) (let ((_51 _54)) (let ((_66 (- row dist))) (let ((_55 _66)) (let ((_52 _55)) (let ((_67 (= _51 _52))) (let ((_56 _67)) (let ((_53 _56)) (let ((_68 (not _53))) (let ((_57 _68)) (let ((_69 (+ dist 1))) (let ((_58 _69)) (let ((_70 (cdr placed))) (let ((_59 _70)) (let ((_71 (ok? row _58 _59))) (let ((_60 _71)) (let ((_72 (and _50 _57 _60))) _72)))))))))))))))))))))))))))))))))) (letrec ((try-it (lambda (x y z) (let ((_73 (null? x))) (if _73 (let ((_74 (null? y))) (if _74 1 0)) (let ((_93 (car x))) (let ((_75 _93)) (let ((_94 (ok? _75 1 z))) (let ((_76 _94)) (let ((_95 (if _76 (let ((_81 (cdr x))) (let ((_77 _81)) (let ((_82 (append _77 y))) (let ((_78 _82)) (let ((_83 (quote ()))) (let ((_84 (car x))) (let ((_79 _84)) (let ((_85 (cons _79 z))) (let ((_80 _85)) (let ((_86 (try-it _78 _83 _80))) _86)))))))))) 0))) (let ((_96 (cdr x))) (let ((_89 _96)) (let ((_97 (car x))) (let ((_90 _97)) (let ((_87 _90)) (let ((_98 (cons _87 y))) (let ((_91 _98)) (let ((_88 _91)) (let ((_99 (try-it _89 _88 z))) (let ((_92 _99)) (let ((_100 (+ _95 _92))) _100))))))))))))))))))))) (letrec ((nqueens (lambda (n) (let ((_101 (one-to n))) (let ((_102 (quote ()))) (let ((_103 (quote ()))) (let ((_104 (try-it _101 _102 _103))) _104))))))) (nqueens 8))))))
